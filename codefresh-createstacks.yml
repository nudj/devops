version: '1.0'

steps:

  create_vpc:
    image: nudj/devops:aws
    working_directory: IMAGE_WORK_DIR
    description: Create the initial VPC
    commands:
      - ./scripts/create-stack.sh -s vpc -e core
      - ./scripts/create-stack.sh -s env -e test -d core-vpc -v core-vpc
      - ./scripts/create-stack.sh -s alb -e test -d test-env -v core-vpc
      - ./scripts/create-stack.sh -s ecs -e test -d test-alb -v core-vpc
      - ./scripts/create-stack.sh -s service -e test -c web -d test-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e test -c admin -d test-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e test -c hire -d test-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e test -c db -d test-ecs -v core-vpc
