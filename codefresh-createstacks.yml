version: '1.0'

steps:

  create_vpc:
    image: nudj/devops:aws
    working_directory: IMAGE_WORK_DIR
    description: Create the initial VPC
    commands:
      - ./scripts/create-stack.sh -s vpc -e core
      - ./scripts/create-stack.sh -s env -e dev -d core-vpc -v core-vpc
      - ./scripts/create-stack.sh -s alb -e dev -d dev-env -v core-vpc
      - ./scripts/create-stack.sh -s ecs -e dev -d dev-alb -v core-vpc
      - ./scripts/create-stack.sh -s service -e dev -c web -d dev-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e dev -c admin -d dev-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e dev -c hire -d dev-ecs -v core-vpc
      # - ./scripts/create-stack.sh -s service -e dev -c db -d dev-ecs -v core-vpc
